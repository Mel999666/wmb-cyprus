<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Wacken Metal Battle Cyprus</title>
<style>
  :root{
    --bg:#0a0a0b; 
    --panel:#151215; 
    --text:#f2f2f2; 
    --muted:#b8b6bb;
    --line:#2b2023; 
    --ring:rgba(255,90,31,.35);
    --maroon-1:#c01722;
    --maroon-2:#8b0f17;
    --maroon-border:#6b0c12;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  body{
    background:linear-gradient(180deg,#0d0b0d,#080708 65%);
    color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
  }
  a{text-decoration:none;color:#ffd7c3}
  header{
    display:flex;justify-content:space-between;align-items:center;
    padding:20px 24px;flex-wrap:wrap;
  }
  header h1{
    display:flex;align-items:center;gap:10px;font-size:22px;font-weight:800;margin:0;
  }
  header h1 img{height:36px;width:auto}
  nav{display:flex;gap:10px;flex-wrap:wrap}
  .pill{
    display:inline-flex;align-items:center;gap:6px;
    padding:8px 14px;border-radius:999px;
    background:#1a1416;border:1px solid var(--line);
    font-size:14px;font-weight:600;color:#fff;
  }

  /* MAROON STYLE FOR TOP NAV BUTTONS */
  header nav .pill{
    background:linear-gradient(180deg,var(--maroon-1),var(--maroon-2));
    border-color:var(--maroon-border);
    color:#ffefe9;
  }
  header nav .pill:hover{filter:brightness(1.08)}

  main{max-width:1100px;margin:0 auto;padding:20px}
  .leaderboard{
    margin-top:30px;
    border:1px solid var(--line);
    border-radius:16px;
    padding:16px;
    background:linear-gradient(180deg,#181316,#110f10);
    box-shadow:0 18px 40px rgba(0,0,0,.45);
  }
  .leaderboard h2{
    font-size:22px;font-weight:800;margin-bottom:12px;color:#fff;
  }
  table{width:100%;border-collapse:collapse}
  th,td{padding:8px 12px;border-bottom:1px solid var(--line)}
  th{text-align:left;font-weight:700;font-size:14px;color:#ffb3b3}
  td{font-size:14px;color:var(--text)}
  .right{text-align:right}

  .band-grid{display:grid;gap:20px;margin-top:20px}
  .band-card{
    border:1px solid var(--line);border-radius:16px;overflow:hidden;
    background:linear-gradient(180deg,#181316,#110f10);
    box-shadow:0 8px 20px rgba(0,0,0,.4);
  }
  .band-card h3{margin:0;font-size:18px;font-weight:800;padding:12px 16px}
  .band-card .meta{padding:0 16px 8px;color:var(--muted);font-size:13px}
  .band-card iframe{width:100%;height:200px;border:none}
  .band-card .stats{padding:12px 16px;display:flex;flex-wrap:wrap;gap:10px}
  .band-card .stats span{font-size:13px;color:#f2f2f2}

  .footer{
    text-align:center;padding:24px 10px;font-size:14px;color:var(--muted);
    border-top:1px solid var(--line);margin-top:40px;
  }
  .footer a{color:#ffd7c3}
  
  .cta{
    display:block;width:100%;max-width:320px;margin:30px auto 0 auto;
    background:#2a6b3a;color:#fff;text-align:center;font-weight:700;
    padding:14px 20px;border:none;border-radius:12px;font-size:16px;
    text-decoration:none;
  }
  .cta:hover{filter:brightness(1.1)}
</style>
</head>
<body>
  <header>
    <h1><img src="/logo.png" alt="Logo">Wacken Metal Battle Cyprus</h1>
    <nav>
      <a href="/judge.html" class="pill">Judges</a>
      <a href="/results.html" class="pill">Admin only</a>
    </nav>
  </header>

  <main>
    <section class="leaderboard">
      <h2>Leaderboard</h2>
      <table>
        <thead>
          <tr>
            <th>Band</th>
            <th class="right">Artist Popularity</th>
            <th class="right">Facebook Followers</th>
            <th class="right">YouTube Views</th>
            <th class="right">Instagram Followers</th>
          </tr>
        </thead>
        <tbody id="leaderRows">
          <tr><td colspan="5" class="muted">Loading live data...</td></tr>
        </tbody>
      </table>
    </section>

    <div id="bands" class="band-grid"></div>

    <a href="/judge.html" class="cta">Go to Judges Scoring Page</a>
  </main>

  <footer class="footer">
    Created by <a href="https://www.instagram.com/rockisland_events/" target="_blank" rel="noopener">Rock Island Events</a>
  </footer>

<script>
  async function loadBands(){
    await new Promise((resolve)=>{
      const s=document.createElement('script');
      s.src='/bands.js?v=index';
      s.onload=resolve; s.onerror=resolve;
      document.head.appendChild(s);
    });
    return Array.isArray(window.BANDS)?window.BANDS:[];
  }

  function esc(s){return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

  async function main(){
    const bands=await loadBands();
    const wrap=document.getElementById('bands');
    wrap.innerHTML=bands.map(b=>{
      const ytid=b.youtube?.split('v=')[1]?.split('&')[0]||'';
      const media=ytid?`<iframe src="https://www.youtube-nocookie.com/embed/${ytid}" allowfullscreen></iframe>`:'';
      return `<article class="band-card">
        <h3>${esc(b.name)}</h3>
        <div class="meta">${esc(b.city||'')}${b.city&&b.genre?' Â· ':''}${esc(b.genre||'')}</div>
        ${media}
        <div class="stats">
          ${b.facebook?`<span>Facebook</span>`:''}
          ${b.instagram?`<span>Instagram</span>`:''}
        </div>
      </article>`;
    }).join('');
  }
  main();
</script>
</body>
</html>
